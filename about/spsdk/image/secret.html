<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>spsdk.image.secret API documentation</title>
<meta name="description" content="Commands and responses used by SDP module." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>spsdk.image.secret</code></h1>
</header>
<section id="section-intro">
<p>Commands and responses used by SDP module.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#!/usr/bin/env python
# -*- coding: UTF-8 -*-
#
# Copyright 2017-2018 Martin Olejar
# Copyright 2019-2020 NXP
#
# SPDX-License-Identifier: BSD-3-Clause

&#34;&#34;&#34;Commands and responses used by SDP module.&#34;&#34;&#34;

from hashlib import sha256
from struct import pack, unpack_from, unpack
from typing import List, Optional, Union, Any, Iterator, no_type_check

from cryptography.x509 import Certificate


from spsdk.utils.easy_enum import Enum
from spsdk.utils.misc import DebugInfo
from .header import SegTag, Header
from .misc import modulus_fmt


class EnumAlgorithm(Enum):
    &#34;&#34;&#34;Algorithm types.&#34;&#34;&#34;
    ANY = (0x00, &#39;Algorithm type ANY&#39;)
    HASH = (0x01, &#39;Hash algorithm type&#39;)
    SIG = (0x02, &#39;Signature algorithm type&#39;)
    F = (0x03, &#39;Finite field arithmetic&#39;)
    EC = (0x04, &#39;Elliptic curve arithmetic&#39;)
    CIPHER = (0x05, &#39;Cipher algorithm type&#39;)
    MODE = (0x06, &#39;Cipher/hash modes&#39;)
    WRAP = (0x07, &#39;Key wrap algorithm type&#39;)
    # Hash algorithms
    SHA1 = (0x11, &#39;SHA-1 algorithm ID&#39;)
    SHA256 = (0x17, &#39;SHA-256 algorithm ID&#39;)
    SHA512 = (0x1b, &#39;SHA-512 algorithm ID&#39;)
    # Signature algorithms
    PKCS1 = (0x21, &#39;PKCS#1 RSA signature algorithm&#39;)
    # Cipher algorithms
    AES = (0x55, &#39;AES algorithm ID&#39;)
    # Cipher or hash modes
    CCM = (0x66, &#39;Counter with CBC-MAC&#39;)
    # Key wrap algorithms
    BLOB = (0x71, &#39;SHW-specific key wrap&#39;)


class BaseClass:
    &#34;&#34;&#34;Base SPSDK class.&#34;&#34;&#34;

    def __init__(self, tag: SegTag, version: int = 0x40):
        &#34;&#34;&#34;Constructor.

        :param tag: section TAG
        :param version: format version
        &#34;&#34;&#34;
        self._header = Header(tag=tag, param=version)

    @property
    def version(self) -&gt; int:
        &#34;&#34;&#34;Format version.&#34;&#34;&#34;
        return self._header.param

    @property
    def version_major(self) -&gt; int:
        &#34;&#34;&#34;Major format version.&#34;&#34;&#34;
        return self.version &gt;&gt; 4

    @property
    def version_minor(self) -&gt; int:
        &#34;&#34;&#34;Minor format version.&#34;&#34;&#34;
        return self.version &amp; 0xF

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of the exported binary data.&#34;&#34;&#34;
        raise NotImplementedError()

    def info(self) -&gt; str:
        &#34;&#34;&#34;Description about the instance.&#34;&#34;&#34;
        raise NotImplementedError()

    def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
        &#34;&#34;&#34;Serialization to binary form.

        :param dbg_info: optional instance allowing to debug exported data; provides commented export
        :return: binary representation of the instance
        &#34;&#34;&#34;
        raise NotImplementedError()


class SecretKeyBlob:
    &#34;&#34;&#34;Secret Key Blob.&#34;&#34;&#34;

    @property
    def blob(self) -&gt; bytes:
        &#34;&#34;&#34;Data of Secret Key Blob.&#34;&#34;&#34;
        return self._data

    @blob.setter
    def blob(self, value: Union[bytes, bytearray]) -&gt; None:
        assert isinstance(value, (bytes, bytearray))
        self._data = value

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of Secret Key Blob.&#34;&#34;&#34;
        return len(self._data) + 4

    def __init__(self, mode: int, algorithm: int, flag: int) -&gt; None:
        &#34;&#34;&#34;Initialize Secret Key Blob.&#34;&#34;&#34;
        self.mode = mode
        self.algorithm = algorithm
        self.flag = flag
        self._data = bytearray()

    def __repr__(self) -&gt; str:
        return &#34;SecKeyBlob &lt;Mode: {}, Algo: {}, Flag: 0x{:02X}, Size: {}&gt;&#34;.format(self.mode, self.algorithm,
                                                                                  self.flag, len(self._data))

    def __eq__(self, obj: Any) -&gt; bool:
        return isinstance(obj, SecretKeyBlob) and vars(obj) == vars(self)

    def __ne__(self, obj: Any) -&gt; bool:
        return not self.__eq__(obj)

    def info(self) -&gt; str:
        &#34;&#34;&#34;String representation of the Secret Key Blob.&#34;&#34;&#34;
        msg = &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;SecKeyBlob\n&#34;
        msg += &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;Mode:      {}\n&#34;.format(self.mode)
        msg += &#34;Algorithm: {}\n&#34;.format(self.algorithm)
        msg += &#34;Flag:      0x{:02X}\n&#34;.format(self.flag)
        msg += &#34;Size:      {} Bytes\n&#34;.format(len(self._data))
        return msg

    def export(self) -&gt; bytes:
        &#34;&#34;&#34;Export of Secret Key Blob.&#34;&#34;&#34;
        raw_data = pack(&#34;4B&#34;, self.mode, self.algorithm, self.size, self.flag)
        raw_data += bytes(self._data)
        return raw_data

    @classmethod
    def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;SecretKeyBlob&#39;:
        &#34;&#34;&#34;Parse of Secret Key Blob.&#34;&#34;&#34;
        (mode, alg, size, flg) = unpack_from(&#34;4B&#34;, data, offset)
        offset += 4
        obj = cls(mode, alg, flg)
        obj.blob = data[offset: offset + size]
        return obj


class CertificateImg(BaseClass):
    &#34;&#34;&#34;Certificate structure for bootable image.&#34;&#34;&#34;

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of Certificate structure for bootable image.&#34;&#34;&#34;
        return Header.SIZE + len(self._data)

    def __init__(self, version: int = 0x40, data: bytes = None) -&gt; None:
        &#34;&#34;&#34;Initialize the certificate structure for bootable image.&#34;&#34;&#34;
        super().__init__(SegTag.CRT, version)
        self._data = bytearray() if data is None else bytearray(data)

    def __repr__(self) -&gt; str:
        return f&#34;Certificate &lt;Ver: {self.version_major}.{self.version_minor}, Size: {len(self._data)}&gt;&#34;

    def __eq__(self, obj: Any) -&gt; bool:
        return isinstance(obj, CertificateImg) and vars(obj) == vars(self)

    def __ne__(self, obj: Any) -&gt; bool:
        return not self.__eq__(obj)

    def __len__(self) -&gt; int:
        return len(self._data)

    def __getitem__(self, key: int) -&gt; int:
        return self._data[key]

    def __setitem__(self, key: int, value: int) -&gt; None:
        self._data[key] = value

    def __iter__(self) -&gt; Iterator[int]:
        return self._data.__iter__()

    def info(self) -&gt; str:
        &#34;&#34;&#34;String representation of the CertificateImg.&#34;&#34;&#34;
        msg = &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;Certificate (Ver: {:X}.{:X}, Size: {})\n&#34;.format(self.version &gt;&gt; 4, self.version &amp; 0xF, len(self._data))
        msg += &#34;-&#34; * 60 + &#34;\n&#34;
        return msg

    def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
        &#34;&#34;&#34;Export.&#34;&#34;&#34;
        self._header.length = self.size
        raw_data = self._header.export()
        dbg_info.append_binary_section(&#39;header&#39;, raw_data)
        raw_data += self._data
        dbg_info.append_binary_section(&#39;data&#39;, self._data)
        return raw_data

    @classmethod
    def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;CertificateImg&#39;:
        &#34;&#34;&#34;Parse.&#34;&#34;&#34;
        header = Header.parse(data, offset, SegTag.CRT)
        offset += Header.SIZE
        return cls(header.param, data[offset: offset + header.length - Header.SIZE])


class Signature(BaseClass):
    &#34;&#34;&#34;Class representing a signature.&#34;&#34;&#34;

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of a signature.&#34;&#34;&#34;
        return Header.SIZE + len(self._data)

    def __init__(self, version: int = 0x40, data: bytes = None) -&gt; None:
        &#34;&#34;&#34;Initialize the signature.&#34;&#34;&#34;
        super().__init__(tag=SegTag.SIG, version=version)
        self._data = bytearray() if data is None else bytearray(data)

    def __repr__(self) -&gt; str:
        return f&#34;Signature &lt;Ver: {self.version &gt;&gt; 4}.{self.version &amp; 0xF}, Size: {len(self._data)}&gt;&#34;

    def __eq__(self, obj: Any) -&gt; bool:
        return isinstance(obj, Signature) and vars(obj) == vars(self)

    def __ne__(self, obj: Any) -&gt; bool:
        return not self.__eq__(obj)

    def __len__(self) -&gt; int:
        return len(self._data)

    def __getitem__(self, key: int) -&gt; int:
        return self._data[key]

    def __setitem__(self, key: int, value: int) -&gt; None:
        self._data[key] = value

    def __iter__(self) -&gt; Iterator[int]:
        return self._data.__iter__()

    def info(self) -&gt; str:
        &#34;&#34;&#34;String representation of the signature.&#34;&#34;&#34;
        msg = &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;Signature (Ver: {:X}.{:X}, Size: {})\n&#34;.format(self.version &gt;&gt; 4, self.version &amp; 0xF, len(self._data))
        msg += &#34;-&#34; * 60 + &#34;\n&#34;
        return msg

    @property
    def data(self) -&gt; bytes:
        &#34;&#34;&#34;Signature data.&#34;&#34;&#34;
        return bytes(self._data)

    @data.setter
    def data(self, value: Union[bytes, bytearray]) -&gt; None:
        &#34;&#34;&#34;Signature data.&#34;&#34;&#34;
        self._data = bytearray(value)

    def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
        &#34;&#34;&#34;Export.&#34;&#34;&#34;
        self._header.length = self.size
        raw_data = self._header.export()
        dbg_info.append_binary_section(&#39;header&#39;, raw_data)
        raw_data += self.data
        dbg_info.append_binary_section(&#39;data&#39;, self.data)
        return raw_data

    @classmethod
    def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;Signature&#39;:
        &#34;&#34;&#34;Parse.&#34;&#34;&#34;
        header = Header.parse(data, offset, SegTag.SIG)
        offset += Header.SIZE
        return cls(header.param, data[offset: offset + header.length - Header.SIZE])


class MAC(BaseClass):
    &#34;&#34;&#34;Structure that holds initial parameter for AES encryption/description.

    - nonce - initialization vector for AEAD AES128 decryption
    - mac - message authentication code to verify the decryption was successful
    &#34;&#34;&#34;

    # AES block size in bytes; This also match size of the MAC and
    AES128_BLK_LEN = 16

    def __init__(self, version: int = 0x40, nonce_len: int = 0, mac_len: int = AES128_BLK_LEN,
                 data: Optional[bytes] = None):
        &#34;&#34;&#34;Constructor.

        :param version: format version, should be 0x4x
        :param nonce_len: number of NONCE bytes
        :param mac_len: number of MAC bytes
        :param data: nonce and mac bytes joined together
        &#34;&#34;&#34;
        super().__init__(tag=SegTag.MAC, version=version)
        self.nonce_len = nonce_len
        self.mac_len = mac_len
        self._data: bytes = bytes() if data is None else bytes(data)
        if data:
            self._validate_data()

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of binary representation in bytes.&#34;&#34;&#34;
        return Header.SIZE + 4 + self.nonce_len + self.mac_len

    def _validate_data(self) -&gt; None:
        &#34;&#34;&#34;Validates the data.

        :raise ValueError: if data length does not match with parameters
        &#34;&#34;&#34;
        if len(self.data) != self.nonce_len + self.mac_len:
            raise ValueError(f&#34;length of data ({len(self.data)}) does not match with &#34;
                             f&#34;nonce_bytes({self.nonce_len})+mac_bytes({self.mac_len})&#34;)

    @property
    def data(self) -&gt; bytes:
        &#34;&#34;&#34;NONCE and MAC bytes joined together.&#34;&#34;&#34;
        return self._data

    @data.setter
    def data(self, value: bytes) -&gt; None:
        &#34;&#34;&#34;Setter.

        :param value: NONCE and MAC bytes joined together
        &#34;&#34;&#34;
        self._data = value
        self._validate_data()

    @property
    def nonce(self) -&gt; bytes:
        &#34;&#34;&#34;NONCE bytes for the encryption/decryption.&#34;&#34;&#34;
        self._validate_data()
        return self._data[0:self.nonce_len]

    @property
    def mac(self) -&gt; bytes:
        &#34;&#34;&#34;MAC bytes for the encryption/decryption.&#34;&#34;&#34;
        self._validate_data()
        return self._data[self.nonce_len: self.nonce_len + self.mac_len]

    def update_aead_encryption_params(self, nonce: bytes, mac: bytes) -&gt; None:
        &#34;&#34;&#34;Update AEAD encryption parameters for encrypted image.

        :param nonce: initialization vector, length depends on image size,
        :param mac: message authentication code used to authenticate uncrypted data, 16 bytes
        &#34;&#34;&#34;
        assert len(mac) == MAC.AES128_BLK_LEN
        assert 11 &lt;= len(nonce) &lt;= 13
        self.nonce_len = len(nonce)
        assert self.mac_len == MAC.AES128_BLK_LEN
        self.data = nonce + mac

    def __repr__(self) -&gt; str:
        return &#34;MAC &lt;Ver: {:X}.{:X}, Nonce: {}, MAC: {}&gt;&#34;.format(self.version_major, self.version_minor,
                                                                 self.nonce_len, self.mac_len)

    def __eq__(self, obj: Any) -&gt; bool:
        return isinstance(obj, MAC) and vars(obj) == vars(self)

    def __ne__(self, obj: Any) -&gt; bool:
        return not self.__eq__(obj)

    def __len__(self) -&gt; int:
        return len(self._data)

    def info(self) -&gt; str:
        &#34;&#34;&#34;Text info about the instance.&#34;&#34;&#34;
        msg = &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;MAC (Version: {:X}.{:X})\n&#34;.format(self.version &gt;&gt; 4, self.version &amp; 0xF)
        msg += &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;Nonce Len: {} Bytes\n&#34;.format(self.nonce_len)
        msg += &#34;MAC Len:   {} Bytes\n&#34;.format(self.mac_len)
        msg += f&#34;[{self._data.hex()}]\n&#34;
        return msg

    def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
        &#34;&#34;&#34;Export instance into binary form (serialization).

        :param dbg_info: optional instance providing debug info about exported content
        :return: binary form
        &#34;&#34;&#34;
        self._validate_data()
        self._header.length = self.size
        raw_data = self._header.export()
        dbg_info.append_binary_data(&#39;header&#39;, raw_data)
        raw_data += pack(&#34;&gt;4B&#34;, 0, self.nonce_len, 0, self.mac_len)
        dbg_info.append(&#39;nonce=&#39; + self.nonce.hex())
        dbg_info.append(&#39;mac=&#39; + self.mac.hex())
        raw_data += self.data
        return raw_data

    @classmethod
    def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;MAC&#39;:
        &#34;&#34;&#34;Parse binary data and creates the instance (deserialization).

        :param data: being parsed
        :param offset: to start parse the data
        :return: the instance
        &#34;&#34;&#34;
        header = Header.parse(data, offset, SegTag.MAC)
        offset += Header.SIZE
        (_, nonce_bytes, _, mac_bytes) = unpack_from(&#34;&gt;4B&#34;, data, offset)
        offset += 4
        return cls(header.param, nonce_bytes, mac_bytes, data[offset: offset + header.length - (Header.SIZE + 4)])


class SrkItem:
    &#34;&#34;&#34;Item in SRK Table, see `SrkTable` class.&#34;&#34;&#34;

    SRK_TAG = 0xE1

    @property
    def algorithm(self) -&gt; int:
        &#34;&#34;&#34;Algorithm.&#34;&#34;&#34;
        return self._header.param

    @property
    def flag(self) -&gt; int:
        &#34;&#34;&#34;Flag.&#34;&#34;&#34;
        return self._flag

    @flag.setter
    def flag(self, value: int) -&gt; None:
        assert value in (0, 0x80)
        self._flag = value

    @property
    def key_length(self) -&gt; int:
        &#34;&#34;&#34;Key length of Item in SRK Table.&#34;&#34;&#34;
        return len(self.modulus) * 8

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of SrkItem.&#34;&#34;&#34;
        return self._header.length

    def __init__(self, modulus: bytes, exponent: bytes, flag: int = 0,
                 algorithm: int = EnumAlgorithm.PKCS1) -&gt; None:
        &#34;&#34;&#34;Initialize the srk table item.&#34;&#34;&#34;
        assert isinstance(modulus, bytes)
        assert isinstance(exponent, bytes)
        self._header = Header(tag=self.SRK_TAG, param=algorithm)
        self.flag = flag
        self.modulus = modulus
        self.exponent = exponent
        self._header.length += 8 + len(self.modulus) + len(self.exponent)

    def __repr__(self) -&gt; str:
        return &#34;SRK &lt;Algorithm: {}, CA: {}&gt;&#34;.format(EnumAlgorithm[self.algorithm],  # type: ignore
                                                    &#39;YES&#39; if self.flag == 0x80 else &#39;NO&#39;)  # type: ignore

    def __eq__(self, obj: Any) -&gt; bool:
        return isinstance(obj, SrkItem) and vars(obj) == vars(self)

    def __ne__(self, obj: Any) -&gt; bool:
        return not self.__eq__(obj)

    def info(self) -&gt; str:
        &#34;&#34;&#34;String representation of SrkItem.&#34;&#34;&#34;
        msg = str()
        msg += &#34;Algorithm: {}\n&#34;.format(EnumAlgorithm[self.algorithm])  # type: ignore
        msg += &#34;Flag:      0x{:02X} {}\n&#34;.format(self.flag, &#39;(CA)&#39; if self.flag == 0x80 else &#39;&#39;)
        msg += &#34;Length:    {} bit\n&#34;.format(self.key_length)
        msg += &#34;Modulus:\n&#34;
        msg += modulus_fmt(self.modulus)
        msg += &#34;\n&#34;
        msg += &#34;Exponent: {0} (0x{0:X})\n&#34;.format(int.from_bytes(self.exponent, &#39;big&#39;))
        return msg

    def export(self) -&gt; bytes:
        &#34;&#34;&#34;Export.&#34;&#34;&#34;
        data = self._header.export()
        data += pack(&#34;&gt;4B2H&#34;, 0, 0, 0, self.flag, len(self.modulus), len(self.exponent))
        data += bytes(self.modulus)
        data += bytes(self.exponent)
        return data

    @classmethod
    def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;SrkItem&#39;:
        &#34;&#34;&#34;Parse segment from bytes array.

        :param data: The bytes array of SRK segment
        :param offset: The offset of input data
        :return: SrkItem: SrkItem object
        &#34;&#34;&#34;
        header = Header.parse(data, offset, cls.SRK_TAG)
        offset += Header.SIZE + 3
        (flag, modulus_len, exponent_len) = unpack_from(&#34;&gt;B2H&#34;, data, offset)
        offset += 5
        modulus = data[offset: offset + modulus_len]
        offset += modulus_len
        exponent = data[offset: offset + exponent_len]
        return cls(modulus, exponent, flag, header.param)

    @classmethod
    @no_type_check
    def from_certificate(cls, cert: Certificate) -&gt; &#39;SrkItem&#39;:
        &#34;&#34;&#34;Create SRKItem from certificate.&#34;&#34;&#34;
        assert isinstance(cert, Certificate)

        flag = 0

        for extension in cert.extensions:
            if extension.oid._name == &#39;keyUsage&#39;:
                if extension.value.key_cert_sign:
                    flag = 0x80

        # get modulus and exponent of public key
        pub_key_numbers = cert.public_key().public_numbers()
        modulus_len = pub_key_numbers.n.bit_length() // 8
        if pub_key_numbers.n.bit_length() % 8:
            modulus_len += 1
        exponent_len = pub_key_numbers.e.bit_length() // 8
        if pub_key_numbers.e.bit_length() % 8:
            exponent_len += 1
        modulus = pub_key_numbers.n.to_bytes(modulus_len, &#34;big&#34;)
        exponent = pub_key_numbers.e.to_bytes(exponent_len, &#34;big&#34;)

        return cls(modulus, exponent, flag)


class SrkTable(BaseClass):
    &#34;&#34;&#34;SRK table.&#34;&#34;&#34;

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of SRK table.&#34;&#34;&#34;
        size = Header.SIZE
        for key in self._keys:
            size += key.size
        return size

    def __init__(self, version: int = 0x40) -&gt; None:
        &#34;&#34;&#34;Initialize SRT Table.

        :param version: format version
        &#34;&#34;&#34;
        super().__init__(tag=SegTag.CRT, version=version)
        self._keys: List[SrkItem] = []

    def __repr__(self) -&gt; str:
        return &#34;SRK_Table &lt;Version: {:X}.{:X}, Keys: {}&gt;&#34;.format(self.version_major,
                                                                 self.version_minor, len(self._keys))

    def __eq__(self, obj: Any) -&gt; bool:
        return isinstance(obj, SrkTable) and vars(obj) == vars(self)

    def __ne__(self, obj: Any) -&gt; bool:
        return not self.__eq__(obj)

    def __len__(self) -&gt; int:
        return len(self._keys)

    def __getitem__(self, key: int) -&gt; SrkItem:
        return self._keys[key]

    def __setitem__(self, key: int, value: SrkItem) -&gt; None:
        assert isinstance(value, SrkItem)
        self._keys[key] = value

    def __iter__(self) -&gt; Iterator[SrkItem]:
        return self._keys.__iter__()

    def info(self) -&gt; str:
        &#34;&#34;&#34;Text info about the instance.&#34;&#34;&#34;
        msg = &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;SRK Table (Version: {:X}.{:X}, #Keys: {})\n&#34;.format(self.version_major,
                                                                    self.version_minor,
                                                                    len(self._keys))
        msg += &#34;-&#34; * 60 + &#34;\n&#34;
        for i, srk in enumerate(self._keys):
            msg += f&#34;SRK Key Index: {i} \n&#34;
            msg += srk.info()
            msg += &#34;\n&#34;
        return msg

    def append(self, srk: SrkItem) -&gt; None:
        &#34;&#34;&#34;Add SRK item.

        :param srk: item to be added
        &#34;&#34;&#34;
        self._keys.append(srk)

    def get_fuse(self, index: int) -&gt; int:
        &#34;&#34;&#34;Retrieve fuse value for the given index.

        :param index: of the fuse, 0-7
        :return: value of the specified fuse; the value is in format, that cane be used as parameter for SDP
                `efuse_read_once` or `efuse_write_once`
        &#34;&#34;&#34;
        assert 0 &lt;= index &lt; 8
        int_data = self.export_fuses()[index * 4: (1 + index) * 4]
        assert len(int_data) == 4
        return unpack(&#34;&lt;I&#34;, int_data)[0]

    def export_fuses(self) -&gt; bytes:
        &#34;&#34;&#34;SRK items in binary form, see `SRK_fuses.bin` file.&#34;&#34;&#34;
        data = b&#39;&#39;
        for srk in self._keys:
            srk_data = srk.export()
            data += sha256(srk_data).digest()
        return sha256(data).digest()

    def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
        &#34;&#34;&#34;Export into binary form (serialization).

        :param dbg_info: optional instance allowing to debug exported content
        :return: binary representation of the instance
        &#34;&#34;&#34;
        self._header.length = self.size
        raw_data = self._header.export()
        dbg_info.append_binary_section(&#39;header&#39;, raw_data)
        for srk in self._keys:
            item_data = srk.export()
            raw_data += item_data
            dbg_info.append_binary_section(&#39;srk_item&#39;, item_data)
        return raw_data

    @classmethod
    def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;SrkTable&#39;:
        &#34;&#34;&#34;Parse of SRK table.&#34;&#34;&#34;
        header = Header.parse(data, offset, SegTag.CRT)
        offset += Header.SIZE
        obj = cls(header.param)
        obj._header.length = header.length
        length = header.length - Header.SIZE
        while length &gt; 0:
            srk = SrkItem.parse(data, offset)
            offset += srk.size
            length -= srk.size
            obj.append(srk)
        return obj</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="spsdk.image.secret.BaseClass"><code class="flex name class">
<span>class <span class="ident">BaseClass</span></span>
<span>(</span><span>tag: <a title="spsdk.image.header.SegTag" href="header.html#spsdk.image.header.SegTag">SegTag</a>, version: int = 64)</span>
</code></dt>
<dd>
<div class="desc"><p>Base SPSDK class.</p>
<p>Constructor.</p>
<p>:param tag: section TAG
:param version: format version</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class BaseClass:
    &#34;&#34;&#34;Base SPSDK class.&#34;&#34;&#34;

    def __init__(self, tag: SegTag, version: int = 0x40):
        &#34;&#34;&#34;Constructor.

        :param tag: section TAG
        :param version: format version
        &#34;&#34;&#34;
        self._header = Header(tag=tag, param=version)

    @property
    def version(self) -&gt; int:
        &#34;&#34;&#34;Format version.&#34;&#34;&#34;
        return self._header.param

    @property
    def version_major(self) -&gt; int:
        &#34;&#34;&#34;Major format version.&#34;&#34;&#34;
        return self.version &gt;&gt; 4

    @property
    def version_minor(self) -&gt; int:
        &#34;&#34;&#34;Minor format version.&#34;&#34;&#34;
        return self.version &amp; 0xF

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of the exported binary data.&#34;&#34;&#34;
        raise NotImplementedError()

    def info(self) -&gt; str:
        &#34;&#34;&#34;Description about the instance.&#34;&#34;&#34;
        raise NotImplementedError()

    def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
        &#34;&#34;&#34;Serialization to binary form.

        :param dbg_info: optional instance allowing to debug exported data; provides commented export
        :return: binary representation of the instance
        &#34;&#34;&#34;
        raise NotImplementedError()</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="spsdk.image.secret.CertificateImg" href="#spsdk.image.secret.CertificateImg">CertificateImg</a></li>
<li><a title="spsdk.image.secret.MAC" href="#spsdk.image.secret.MAC">MAC</a></li>
<li><a title="spsdk.image.secret.Signature" href="#spsdk.image.secret.Signature">Signature</a></li>
<li><a title="spsdk.image.secret.SrkTable" href="#spsdk.image.secret.SrkTable">SrkTable</a></li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="spsdk.image.secret.BaseClass.size"><code class="name">var <span class="ident">size</span> : int</code></dt>
<dd>
<div class="desc"><p>Size of the exported binary data.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def size(self) -&gt; int:
    &#34;&#34;&#34;Size of the exported binary data.&#34;&#34;&#34;
    raise NotImplementedError()</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.BaseClass.version"><code class="name">var <span class="ident">version</span> : int</code></dt>
<dd>
<div class="desc"><p>Format version.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def version(self) -&gt; int:
    &#34;&#34;&#34;Format version.&#34;&#34;&#34;
    return self._header.param</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.BaseClass.version_major"><code class="name">var <span class="ident">version_major</span> : int</code></dt>
<dd>
<div class="desc"><p>Major format version.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def version_major(self) -&gt; int:
    &#34;&#34;&#34;Major format version.&#34;&#34;&#34;
    return self.version &gt;&gt; 4</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.BaseClass.version_minor"><code class="name">var <span class="ident">version_minor</span> : int</code></dt>
<dd>
<div class="desc"><p>Minor format version.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def version_minor(self) -&gt; int:
    &#34;&#34;&#34;Minor format version.&#34;&#34;&#34;
    return self.version &amp; 0xF</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="spsdk.image.secret.BaseClass.export"><code class="name flex">
<span>def <span class="ident">export</span></span>(<span>self, dbg_info: <a title="spsdk.utils.misc.DebugInfo" href="../utils/misc.html#spsdk.utils.misc.DebugInfo">DebugInfo</a> = &lt;spsdk.utils.misc.DebugInfo object&gt;) ‑> bytes</span>
</code></dt>
<dd>
<div class="desc"><p>Serialization to binary form.</p>
<p>:param dbg_info: optional instance allowing to debug exported data; provides commented export
:return: binary representation of the instance</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
    &#34;&#34;&#34;Serialization to binary form.

    :param dbg_info: optional instance allowing to debug exported data; provides commented export
    :return: binary representation of the instance
    &#34;&#34;&#34;
    raise NotImplementedError()</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.BaseClass.info"><code class="name flex">
<span>def <span class="ident">info</span></span>(<span>self) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>Description about the instance.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def info(self) -&gt; str:
    &#34;&#34;&#34;Description about the instance.&#34;&#34;&#34;
    raise NotImplementedError()</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="spsdk.image.secret.CertificateImg"><code class="flex name class">
<span>class <span class="ident">CertificateImg</span></span>
<span>(</span><span>version: int = 64, data: bytes = None)</span>
</code></dt>
<dd>
<div class="desc"><p>Certificate structure for bootable image.</p>
<p>Initialize the certificate structure for bootable image.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CertificateImg(BaseClass):
    &#34;&#34;&#34;Certificate structure for bootable image.&#34;&#34;&#34;

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of Certificate structure for bootable image.&#34;&#34;&#34;
        return Header.SIZE + len(self._data)

    def __init__(self, version: int = 0x40, data: bytes = None) -&gt; None:
        &#34;&#34;&#34;Initialize the certificate structure for bootable image.&#34;&#34;&#34;
        super().__init__(SegTag.CRT, version)
        self._data = bytearray() if data is None else bytearray(data)

    def __repr__(self) -&gt; str:
        return f&#34;Certificate &lt;Ver: {self.version_major}.{self.version_minor}, Size: {len(self._data)}&gt;&#34;

    def __eq__(self, obj: Any) -&gt; bool:
        return isinstance(obj, CertificateImg) and vars(obj) == vars(self)

    def __ne__(self, obj: Any) -&gt; bool:
        return not self.__eq__(obj)

    def __len__(self) -&gt; int:
        return len(self._data)

    def __getitem__(self, key: int) -&gt; int:
        return self._data[key]

    def __setitem__(self, key: int, value: int) -&gt; None:
        self._data[key] = value

    def __iter__(self) -&gt; Iterator[int]:
        return self._data.__iter__()

    def info(self) -&gt; str:
        &#34;&#34;&#34;String representation of the CertificateImg.&#34;&#34;&#34;
        msg = &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;Certificate (Ver: {:X}.{:X}, Size: {})\n&#34;.format(self.version &gt;&gt; 4, self.version &amp; 0xF, len(self._data))
        msg += &#34;-&#34; * 60 + &#34;\n&#34;
        return msg

    def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
        &#34;&#34;&#34;Export.&#34;&#34;&#34;
        self._header.length = self.size
        raw_data = self._header.export()
        dbg_info.append_binary_section(&#39;header&#39;, raw_data)
        raw_data += self._data
        dbg_info.append_binary_section(&#39;data&#39;, self._data)
        return raw_data

    @classmethod
    def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;CertificateImg&#39;:
        &#34;&#34;&#34;Parse.&#34;&#34;&#34;
        header = Header.parse(data, offset, SegTag.CRT)
        offset += Header.SIZE
        return cls(header.param, data[offset: offset + header.length - Header.SIZE])</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="spsdk.image.secret.BaseClass" href="#spsdk.image.secret.BaseClass">BaseClass</a></li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="spsdk.image.secret.CertificateImg.parse"><code class="name flex">
<span>def <span class="ident">parse</span></span>(<span>data: bytes, offset: int = 0) ‑> <a title="spsdk.image.secret.CertificateImg" href="#spsdk.image.secret.CertificateImg">CertificateImg</a></span>
</code></dt>
<dd>
<div class="desc"><p>Parse.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;CertificateImg&#39;:
    &#34;&#34;&#34;Parse.&#34;&#34;&#34;
    header = Header.parse(data, offset, SegTag.CRT)
    offset += Header.SIZE
    return cls(header.param, data[offset: offset + header.length - Header.SIZE])</code></pre>
</details>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="spsdk.image.secret.CertificateImg.size"><code class="name">var <span class="ident">size</span> : int</code></dt>
<dd>
<div class="desc"><p>Size of Certificate structure for bootable image.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def size(self) -&gt; int:
    &#34;&#34;&#34;Size of Certificate structure for bootable image.&#34;&#34;&#34;
    return Header.SIZE + len(self._data)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="spsdk.image.secret.CertificateImg.export"><code class="name flex">
<span>def <span class="ident">export</span></span>(<span>self, dbg_info: <a title="spsdk.utils.misc.DebugInfo" href="../utils/misc.html#spsdk.utils.misc.DebugInfo">DebugInfo</a> = &lt;spsdk.utils.misc.DebugInfo object&gt;) ‑> bytes</span>
</code></dt>
<dd>
<div class="desc"><p>Export.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
    &#34;&#34;&#34;Export.&#34;&#34;&#34;
    self._header.length = self.size
    raw_data = self._header.export()
    dbg_info.append_binary_section(&#39;header&#39;, raw_data)
    raw_data += self._data
    dbg_info.append_binary_section(&#39;data&#39;, self._data)
    return raw_data</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.CertificateImg.info"><code class="name flex">
<span>def <span class="ident">info</span></span>(<span>self) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>String representation of the CertificateImg.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def info(self) -&gt; str:
    &#34;&#34;&#34;String representation of the CertificateImg.&#34;&#34;&#34;
    msg = &#34;-&#34; * 60 + &#34;\n&#34;
    msg += &#34;Certificate (Ver: {:X}.{:X}, Size: {})\n&#34;.format(self.version &gt;&gt; 4, self.version &amp; 0xF, len(self._data))
    msg += &#34;-&#34; * 60 + &#34;\n&#34;
    return msg</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="spsdk.image.secret.BaseClass" href="#spsdk.image.secret.BaseClass">BaseClass</a></b></code>:
<ul class="hlist">
<li><code><a title="spsdk.image.secret.BaseClass.version" href="#spsdk.image.secret.BaseClass.version">version</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.version_major" href="#spsdk.image.secret.BaseClass.version_major">version_major</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.version_minor" href="#spsdk.image.secret.BaseClass.version_minor">version_minor</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm"><code class="flex name class">
<span>class <span class="ident">EnumAlgorithm</span></span>
</code></dt>
<dd>
<div class="desc"><p>Algorithm types.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class EnumAlgorithm(Enum):
    &#34;&#34;&#34;Algorithm types.&#34;&#34;&#34;
    ANY = (0x00, &#39;Algorithm type ANY&#39;)
    HASH = (0x01, &#39;Hash algorithm type&#39;)
    SIG = (0x02, &#39;Signature algorithm type&#39;)
    F = (0x03, &#39;Finite field arithmetic&#39;)
    EC = (0x04, &#39;Elliptic curve arithmetic&#39;)
    CIPHER = (0x05, &#39;Cipher algorithm type&#39;)
    MODE = (0x06, &#39;Cipher/hash modes&#39;)
    WRAP = (0x07, &#39;Key wrap algorithm type&#39;)
    # Hash algorithms
    SHA1 = (0x11, &#39;SHA-1 algorithm ID&#39;)
    SHA256 = (0x17, &#39;SHA-256 algorithm ID&#39;)
    SHA512 = (0x1b, &#39;SHA-512 algorithm ID&#39;)
    # Signature algorithms
    PKCS1 = (0x21, &#39;PKCS#1 RSA signature algorithm&#39;)
    # Cipher algorithms
    AES = (0x55, &#39;AES algorithm ID&#39;)
    # Cipher or hash modes
    CCM = (0x66, &#39;Counter with CBC-MAC&#39;)
    # Key wrap algorithms
    BLOB = (0x71, &#39;SHW-specific key wrap&#39;)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="spsdk.utils.easy_enum.Enum" href="../utils/easy_enum.html#spsdk.utils.easy_enum.Enum">Enum</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="spsdk.image.secret.EnumAlgorithm.AES"><code class="name">var <span class="ident">AES</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.ANY"><code class="name">var <span class="ident">ANY</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.BLOB"><code class="name">var <span class="ident">BLOB</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.CCM"><code class="name">var <span class="ident">CCM</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.CIPHER"><code class="name">var <span class="ident">CIPHER</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.EC"><code class="name">var <span class="ident">EC</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.F"><code class="name">var <span class="ident">F</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.HASH"><code class="name">var <span class="ident">HASH</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.MODE"><code class="name">var <span class="ident">MODE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.PKCS1"><code class="name">var <span class="ident">PKCS1</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.SHA1"><code class="name">var <span class="ident">SHA1</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.SHA256"><code class="name">var <span class="ident">SHA256</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.SHA512"><code class="name">var <span class="ident">SHA512</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.SIG"><code class="name">var <span class="ident">SIG</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="spsdk.image.secret.EnumAlgorithm.WRAP"><code class="name">var <span class="ident">WRAP</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="spsdk.utils.easy_enum.Enum" href="../utils/easy_enum.html#spsdk.utils.easy_enum.Enum">Enum</a></b></code>:
<ul class="hlist">
<li><code><a title="spsdk.utils.easy_enum.Enum.desc" href="../utils/easy_enum.html#spsdk.utils.easy_enum.Enum.desc">desc</a></code></li>
<li><code><a title="spsdk.utils.easy_enum.Enum.from_int" href="../utils/easy_enum.html#spsdk.utils.easy_enum.Enum.from_int">from_int</a></code></li>
<li><code><a title="spsdk.utils.easy_enum.Enum.get" href="../utils/easy_enum.html#spsdk.utils.easy_enum.Enum.get">get</a></code></li>
<li><code><a title="spsdk.utils.easy_enum.Enum.name" href="../utils/easy_enum.html#spsdk.utils.easy_enum.Enum.name">name</a></code></li>
<li><code><a title="spsdk.utils.easy_enum.Enum.tags" href="../utils/easy_enum.html#spsdk.utils.easy_enum.Enum.tags">tags</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="spsdk.image.secret.MAC"><code class="flex name class">
<span>class <span class="ident">MAC</span></span>
<span>(</span><span>version: int = 64, nonce_len: int = 0, mac_len: int = 16, data: Union[bytes, NoneType] = None)</span>
</code></dt>
<dd>
<div class="desc"><p>Structure that holds initial parameter for AES encryption/description.</p>
<ul>
<li>nonce - initialization vector for AEAD AES128 decryption</li>
<li>mac - message authentication code to verify the decryption was successful</li>
</ul>
<p>Constructor.</p>
<p>:param version: format version, should be 0x4x
:param nonce_len: number of NONCE bytes
:param mac_len: number of MAC bytes
:param data: nonce and mac bytes joined together</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MAC(BaseClass):
    &#34;&#34;&#34;Structure that holds initial parameter for AES encryption/description.

    - nonce - initialization vector for AEAD AES128 decryption
    - mac - message authentication code to verify the decryption was successful
    &#34;&#34;&#34;

    # AES block size in bytes; This also match size of the MAC and
    AES128_BLK_LEN = 16

    def __init__(self, version: int = 0x40, nonce_len: int = 0, mac_len: int = AES128_BLK_LEN,
                 data: Optional[bytes] = None):
        &#34;&#34;&#34;Constructor.

        :param version: format version, should be 0x4x
        :param nonce_len: number of NONCE bytes
        :param mac_len: number of MAC bytes
        :param data: nonce and mac bytes joined together
        &#34;&#34;&#34;
        super().__init__(tag=SegTag.MAC, version=version)
        self.nonce_len = nonce_len
        self.mac_len = mac_len
        self._data: bytes = bytes() if data is None else bytes(data)
        if data:
            self._validate_data()

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of binary representation in bytes.&#34;&#34;&#34;
        return Header.SIZE + 4 + self.nonce_len + self.mac_len

    def _validate_data(self) -&gt; None:
        &#34;&#34;&#34;Validates the data.

        :raise ValueError: if data length does not match with parameters
        &#34;&#34;&#34;
        if len(self.data) != self.nonce_len + self.mac_len:
            raise ValueError(f&#34;length of data ({len(self.data)}) does not match with &#34;
                             f&#34;nonce_bytes({self.nonce_len})+mac_bytes({self.mac_len})&#34;)

    @property
    def data(self) -&gt; bytes:
        &#34;&#34;&#34;NONCE and MAC bytes joined together.&#34;&#34;&#34;
        return self._data

    @data.setter
    def data(self, value: bytes) -&gt; None:
        &#34;&#34;&#34;Setter.

        :param value: NONCE and MAC bytes joined together
        &#34;&#34;&#34;
        self._data = value
        self._validate_data()

    @property
    def nonce(self) -&gt; bytes:
        &#34;&#34;&#34;NONCE bytes for the encryption/decryption.&#34;&#34;&#34;
        self._validate_data()
        return self._data[0:self.nonce_len]

    @property
    def mac(self) -&gt; bytes:
        &#34;&#34;&#34;MAC bytes for the encryption/decryption.&#34;&#34;&#34;
        self._validate_data()
        return self._data[self.nonce_len: self.nonce_len + self.mac_len]

    def update_aead_encryption_params(self, nonce: bytes, mac: bytes) -&gt; None:
        &#34;&#34;&#34;Update AEAD encryption parameters for encrypted image.

        :param nonce: initialization vector, length depends on image size,
        :param mac: message authentication code used to authenticate uncrypted data, 16 bytes
        &#34;&#34;&#34;
        assert len(mac) == MAC.AES128_BLK_LEN
        assert 11 &lt;= len(nonce) &lt;= 13
        self.nonce_len = len(nonce)
        assert self.mac_len == MAC.AES128_BLK_LEN
        self.data = nonce + mac

    def __repr__(self) -&gt; str:
        return &#34;MAC &lt;Ver: {:X}.{:X}, Nonce: {}, MAC: {}&gt;&#34;.format(self.version_major, self.version_minor,
                                                                 self.nonce_len, self.mac_len)

    def __eq__(self, obj: Any) -&gt; bool:
        return isinstance(obj, MAC) and vars(obj) == vars(self)

    def __ne__(self, obj: Any) -&gt; bool:
        return not self.__eq__(obj)

    def __len__(self) -&gt; int:
        return len(self._data)

    def info(self) -&gt; str:
        &#34;&#34;&#34;Text info about the instance.&#34;&#34;&#34;
        msg = &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;MAC (Version: {:X}.{:X})\n&#34;.format(self.version &gt;&gt; 4, self.version &amp; 0xF)
        msg += &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;Nonce Len: {} Bytes\n&#34;.format(self.nonce_len)
        msg += &#34;MAC Len:   {} Bytes\n&#34;.format(self.mac_len)
        msg += f&#34;[{self._data.hex()}]\n&#34;
        return msg

    def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
        &#34;&#34;&#34;Export instance into binary form (serialization).

        :param dbg_info: optional instance providing debug info about exported content
        :return: binary form
        &#34;&#34;&#34;
        self._validate_data()
        self._header.length = self.size
        raw_data = self._header.export()
        dbg_info.append_binary_data(&#39;header&#39;, raw_data)
        raw_data += pack(&#34;&gt;4B&#34;, 0, self.nonce_len, 0, self.mac_len)
        dbg_info.append(&#39;nonce=&#39; + self.nonce.hex())
        dbg_info.append(&#39;mac=&#39; + self.mac.hex())
        raw_data += self.data
        return raw_data

    @classmethod
    def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;MAC&#39;:
        &#34;&#34;&#34;Parse binary data and creates the instance (deserialization).

        :param data: being parsed
        :param offset: to start parse the data
        :return: the instance
        &#34;&#34;&#34;
        header = Header.parse(data, offset, SegTag.MAC)
        offset += Header.SIZE
        (_, nonce_bytes, _, mac_bytes) = unpack_from(&#34;&gt;4B&#34;, data, offset)
        offset += 4
        return cls(header.param, nonce_bytes, mac_bytes, data[offset: offset + header.length - (Header.SIZE + 4)])</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="spsdk.image.secret.BaseClass" href="#spsdk.image.secret.BaseClass">BaseClass</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="spsdk.image.secret.MAC.AES128_BLK_LEN"><code class="name">var <span class="ident">AES128_BLK_LEN</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="spsdk.image.secret.MAC.parse"><code class="name flex">
<span>def <span class="ident">parse</span></span>(<span>data: bytes, offset: int = 0) ‑> <a title="spsdk.image.secret.MAC" href="#spsdk.image.secret.MAC">MAC</a></span>
</code></dt>
<dd>
<div class="desc"><p>Parse binary data and creates the instance (deserialization).</p>
<p>:param data: being parsed
:param offset: to start parse the data
:return: the instance</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;MAC&#39;:
    &#34;&#34;&#34;Parse binary data and creates the instance (deserialization).

    :param data: being parsed
    :param offset: to start parse the data
    :return: the instance
    &#34;&#34;&#34;
    header = Header.parse(data, offset, SegTag.MAC)
    offset += Header.SIZE
    (_, nonce_bytes, _, mac_bytes) = unpack_from(&#34;&gt;4B&#34;, data, offset)
    offset += 4
    return cls(header.param, nonce_bytes, mac_bytes, data[offset: offset + header.length - (Header.SIZE + 4)])</code></pre>
</details>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="spsdk.image.secret.MAC.data"><code class="name">var <span class="ident">data</span> : bytes</code></dt>
<dd>
<div class="desc"><p>NONCE and MAC bytes joined together.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def data(self) -&gt; bytes:
    &#34;&#34;&#34;NONCE and MAC bytes joined together.&#34;&#34;&#34;
    return self._data</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.MAC.mac"><code class="name">var <span class="ident">mac</span> : bytes</code></dt>
<dd>
<div class="desc"><p>MAC bytes for the encryption/decryption.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def mac(self) -&gt; bytes:
    &#34;&#34;&#34;MAC bytes for the encryption/decryption.&#34;&#34;&#34;
    self._validate_data()
    return self._data[self.nonce_len: self.nonce_len + self.mac_len]</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.MAC.nonce"><code class="name">var <span class="ident">nonce</span> : bytes</code></dt>
<dd>
<div class="desc"><p>NONCE bytes for the encryption/decryption.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def nonce(self) -&gt; bytes:
    &#34;&#34;&#34;NONCE bytes for the encryption/decryption.&#34;&#34;&#34;
    self._validate_data()
    return self._data[0:self.nonce_len]</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.MAC.size"><code class="name">var <span class="ident">size</span> : int</code></dt>
<dd>
<div class="desc"><p>Size of binary representation in bytes.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def size(self) -&gt; int:
    &#34;&#34;&#34;Size of binary representation in bytes.&#34;&#34;&#34;
    return Header.SIZE + 4 + self.nonce_len + self.mac_len</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="spsdk.image.secret.MAC.export"><code class="name flex">
<span>def <span class="ident">export</span></span>(<span>self, dbg_info: <a title="spsdk.utils.misc.DebugInfo" href="../utils/misc.html#spsdk.utils.misc.DebugInfo">DebugInfo</a> = &lt;spsdk.utils.misc.DebugInfo object&gt;) ‑> bytes</span>
</code></dt>
<dd>
<div class="desc"><p>Export instance into binary form (serialization).</p>
<p>:param dbg_info: optional instance providing debug info about exported content
:return: binary form</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
    &#34;&#34;&#34;Export instance into binary form (serialization).

    :param dbg_info: optional instance providing debug info about exported content
    :return: binary form
    &#34;&#34;&#34;
    self._validate_data()
    self._header.length = self.size
    raw_data = self._header.export()
    dbg_info.append_binary_data(&#39;header&#39;, raw_data)
    raw_data += pack(&#34;&gt;4B&#34;, 0, self.nonce_len, 0, self.mac_len)
    dbg_info.append(&#39;nonce=&#39; + self.nonce.hex())
    dbg_info.append(&#39;mac=&#39; + self.mac.hex())
    raw_data += self.data
    return raw_data</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.MAC.info"><code class="name flex">
<span>def <span class="ident">info</span></span>(<span>self) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>Text info about the instance.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def info(self) -&gt; str:
    &#34;&#34;&#34;Text info about the instance.&#34;&#34;&#34;
    msg = &#34;-&#34; * 60 + &#34;\n&#34;
    msg += &#34;MAC (Version: {:X}.{:X})\n&#34;.format(self.version &gt;&gt; 4, self.version &amp; 0xF)
    msg += &#34;-&#34; * 60 + &#34;\n&#34;
    msg += &#34;Nonce Len: {} Bytes\n&#34;.format(self.nonce_len)
    msg += &#34;MAC Len:   {} Bytes\n&#34;.format(self.mac_len)
    msg += f&#34;[{self._data.hex()}]\n&#34;
    return msg</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.MAC.update_aead_encryption_params"><code class="name flex">
<span>def <span class="ident">update_aead_encryption_params</span></span>(<span>self, nonce: bytes, mac: bytes) ‑> NoneType</span>
</code></dt>
<dd>
<div class="desc"><p>Update AEAD encryption parameters for encrypted image.</p>
<p>:param nonce: initialization vector, length depends on image size,
:param mac: message authentication code used to authenticate uncrypted data, 16 bytes</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update_aead_encryption_params(self, nonce: bytes, mac: bytes) -&gt; None:
    &#34;&#34;&#34;Update AEAD encryption parameters for encrypted image.

    :param nonce: initialization vector, length depends on image size,
    :param mac: message authentication code used to authenticate uncrypted data, 16 bytes
    &#34;&#34;&#34;
    assert len(mac) == MAC.AES128_BLK_LEN
    assert 11 &lt;= len(nonce) &lt;= 13
    self.nonce_len = len(nonce)
    assert self.mac_len == MAC.AES128_BLK_LEN
    self.data = nonce + mac</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="spsdk.image.secret.BaseClass" href="#spsdk.image.secret.BaseClass">BaseClass</a></b></code>:
<ul class="hlist">
<li><code><a title="spsdk.image.secret.BaseClass.version" href="#spsdk.image.secret.BaseClass.version">version</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.version_major" href="#spsdk.image.secret.BaseClass.version_major">version_major</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.version_minor" href="#spsdk.image.secret.BaseClass.version_minor">version_minor</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="spsdk.image.secret.SecretKeyBlob"><code class="flex name class">
<span>class <span class="ident">SecretKeyBlob</span></span>
<span>(</span><span>mode: int, algorithm: int, flag: int)</span>
</code></dt>
<dd>
<div class="desc"><p>Secret Key Blob.</p>
<p>Initialize Secret Key Blob.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SecretKeyBlob:
    &#34;&#34;&#34;Secret Key Blob.&#34;&#34;&#34;

    @property
    def blob(self) -&gt; bytes:
        &#34;&#34;&#34;Data of Secret Key Blob.&#34;&#34;&#34;
        return self._data

    @blob.setter
    def blob(self, value: Union[bytes, bytearray]) -&gt; None:
        assert isinstance(value, (bytes, bytearray))
        self._data = value

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of Secret Key Blob.&#34;&#34;&#34;
        return len(self._data) + 4

    def __init__(self, mode: int, algorithm: int, flag: int) -&gt; None:
        &#34;&#34;&#34;Initialize Secret Key Blob.&#34;&#34;&#34;
        self.mode = mode
        self.algorithm = algorithm
        self.flag = flag
        self._data = bytearray()

    def __repr__(self) -&gt; str:
        return &#34;SecKeyBlob &lt;Mode: {}, Algo: {}, Flag: 0x{:02X}, Size: {}&gt;&#34;.format(self.mode, self.algorithm,
                                                                                  self.flag, len(self._data))

    def __eq__(self, obj: Any) -&gt; bool:
        return isinstance(obj, SecretKeyBlob) and vars(obj) == vars(self)

    def __ne__(self, obj: Any) -&gt; bool:
        return not self.__eq__(obj)

    def info(self) -&gt; str:
        &#34;&#34;&#34;String representation of the Secret Key Blob.&#34;&#34;&#34;
        msg = &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;SecKeyBlob\n&#34;
        msg += &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;Mode:      {}\n&#34;.format(self.mode)
        msg += &#34;Algorithm: {}\n&#34;.format(self.algorithm)
        msg += &#34;Flag:      0x{:02X}\n&#34;.format(self.flag)
        msg += &#34;Size:      {} Bytes\n&#34;.format(len(self._data))
        return msg

    def export(self) -&gt; bytes:
        &#34;&#34;&#34;Export of Secret Key Blob.&#34;&#34;&#34;
        raw_data = pack(&#34;4B&#34;, self.mode, self.algorithm, self.size, self.flag)
        raw_data += bytes(self._data)
        return raw_data

    @classmethod
    def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;SecretKeyBlob&#39;:
        &#34;&#34;&#34;Parse of Secret Key Blob.&#34;&#34;&#34;
        (mode, alg, size, flg) = unpack_from(&#34;4B&#34;, data, offset)
        offset += 4
        obj = cls(mode, alg, flg)
        obj.blob = data[offset: offset + size]
        return obj</code></pre>
</details>
<h3>Static methods</h3>
<dl>
<dt id="spsdk.image.secret.SecretKeyBlob.parse"><code class="name flex">
<span>def <span class="ident">parse</span></span>(<span>data: bytes, offset: int = 0) ‑> <a title="spsdk.image.secret.SecretKeyBlob" href="#spsdk.image.secret.SecretKeyBlob">SecretKeyBlob</a></span>
</code></dt>
<dd>
<div class="desc"><p>Parse of Secret Key Blob.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;SecretKeyBlob&#39;:
    &#34;&#34;&#34;Parse of Secret Key Blob.&#34;&#34;&#34;
    (mode, alg, size, flg) = unpack_from(&#34;4B&#34;, data, offset)
    offset += 4
    obj = cls(mode, alg, flg)
    obj.blob = data[offset: offset + size]
    return obj</code></pre>
</details>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="spsdk.image.secret.SecretKeyBlob.blob"><code class="name">var <span class="ident">blob</span> : bytes</code></dt>
<dd>
<div class="desc"><p>Data of Secret Key Blob.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def blob(self) -&gt; bytes:
    &#34;&#34;&#34;Data of Secret Key Blob.&#34;&#34;&#34;
    return self._data</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.SecretKeyBlob.size"><code class="name">var <span class="ident">size</span> : int</code></dt>
<dd>
<div class="desc"><p>Size of Secret Key Blob.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def size(self) -&gt; int:
    &#34;&#34;&#34;Size of Secret Key Blob.&#34;&#34;&#34;
    return len(self._data) + 4</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="spsdk.image.secret.SecretKeyBlob.export"><code class="name flex">
<span>def <span class="ident">export</span></span>(<span>self) ‑> bytes</span>
</code></dt>
<dd>
<div class="desc"><p>Export of Secret Key Blob.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def export(self) -&gt; bytes:
    &#34;&#34;&#34;Export of Secret Key Blob.&#34;&#34;&#34;
    raw_data = pack(&#34;4B&#34;, self.mode, self.algorithm, self.size, self.flag)
    raw_data += bytes(self._data)
    return raw_data</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.SecretKeyBlob.info"><code class="name flex">
<span>def <span class="ident">info</span></span>(<span>self) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>String representation of the Secret Key Blob.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def info(self) -&gt; str:
    &#34;&#34;&#34;String representation of the Secret Key Blob.&#34;&#34;&#34;
    msg = &#34;-&#34; * 60 + &#34;\n&#34;
    msg += &#34;SecKeyBlob\n&#34;
    msg += &#34;-&#34; * 60 + &#34;\n&#34;
    msg += &#34;Mode:      {}\n&#34;.format(self.mode)
    msg += &#34;Algorithm: {}\n&#34;.format(self.algorithm)
    msg += &#34;Flag:      0x{:02X}\n&#34;.format(self.flag)
    msg += &#34;Size:      {} Bytes\n&#34;.format(len(self._data))
    return msg</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="spsdk.image.secret.Signature"><code class="flex name class">
<span>class <span class="ident">Signature</span></span>
<span>(</span><span>version: int = 64, data: bytes = None)</span>
</code></dt>
<dd>
<div class="desc"><p>Class representing a signature.</p>
<p>Initialize the signature.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Signature(BaseClass):
    &#34;&#34;&#34;Class representing a signature.&#34;&#34;&#34;

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of a signature.&#34;&#34;&#34;
        return Header.SIZE + len(self._data)

    def __init__(self, version: int = 0x40, data: bytes = None) -&gt; None:
        &#34;&#34;&#34;Initialize the signature.&#34;&#34;&#34;
        super().__init__(tag=SegTag.SIG, version=version)
        self._data = bytearray() if data is None else bytearray(data)

    def __repr__(self) -&gt; str:
        return f&#34;Signature &lt;Ver: {self.version &gt;&gt; 4}.{self.version &amp; 0xF}, Size: {len(self._data)}&gt;&#34;

    def __eq__(self, obj: Any) -&gt; bool:
        return isinstance(obj, Signature) and vars(obj) == vars(self)

    def __ne__(self, obj: Any) -&gt; bool:
        return not self.__eq__(obj)

    def __len__(self) -&gt; int:
        return len(self._data)

    def __getitem__(self, key: int) -&gt; int:
        return self._data[key]

    def __setitem__(self, key: int, value: int) -&gt; None:
        self._data[key] = value

    def __iter__(self) -&gt; Iterator[int]:
        return self._data.__iter__()

    def info(self) -&gt; str:
        &#34;&#34;&#34;String representation of the signature.&#34;&#34;&#34;
        msg = &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;Signature (Ver: {:X}.{:X}, Size: {})\n&#34;.format(self.version &gt;&gt; 4, self.version &amp; 0xF, len(self._data))
        msg += &#34;-&#34; * 60 + &#34;\n&#34;
        return msg

    @property
    def data(self) -&gt; bytes:
        &#34;&#34;&#34;Signature data.&#34;&#34;&#34;
        return bytes(self._data)

    @data.setter
    def data(self, value: Union[bytes, bytearray]) -&gt; None:
        &#34;&#34;&#34;Signature data.&#34;&#34;&#34;
        self._data = bytearray(value)

    def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
        &#34;&#34;&#34;Export.&#34;&#34;&#34;
        self._header.length = self.size
        raw_data = self._header.export()
        dbg_info.append_binary_section(&#39;header&#39;, raw_data)
        raw_data += self.data
        dbg_info.append_binary_section(&#39;data&#39;, self.data)
        return raw_data

    @classmethod
    def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;Signature&#39;:
        &#34;&#34;&#34;Parse.&#34;&#34;&#34;
        header = Header.parse(data, offset, SegTag.SIG)
        offset += Header.SIZE
        return cls(header.param, data[offset: offset + header.length - Header.SIZE])</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="spsdk.image.secret.BaseClass" href="#spsdk.image.secret.BaseClass">BaseClass</a></li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="spsdk.image.secret.Signature.parse"><code class="name flex">
<span>def <span class="ident">parse</span></span>(<span>data: bytes, offset: int = 0) ‑> <a title="spsdk.image.secret.Signature" href="#spsdk.image.secret.Signature">Signature</a></span>
</code></dt>
<dd>
<div class="desc"><p>Parse.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;Signature&#39;:
    &#34;&#34;&#34;Parse.&#34;&#34;&#34;
    header = Header.parse(data, offset, SegTag.SIG)
    offset += Header.SIZE
    return cls(header.param, data[offset: offset + header.length - Header.SIZE])</code></pre>
</details>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="spsdk.image.secret.Signature.data"><code class="name">var <span class="ident">data</span> : bytes</code></dt>
<dd>
<div class="desc"><p>Signature data.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def data(self) -&gt; bytes:
    &#34;&#34;&#34;Signature data.&#34;&#34;&#34;
    return bytes(self._data)</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.Signature.size"><code class="name">var <span class="ident">size</span> : int</code></dt>
<dd>
<div class="desc"><p>Size of a signature.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def size(self) -&gt; int:
    &#34;&#34;&#34;Size of a signature.&#34;&#34;&#34;
    return Header.SIZE + len(self._data)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="spsdk.image.secret.Signature.export"><code class="name flex">
<span>def <span class="ident">export</span></span>(<span>self, dbg_info: <a title="spsdk.utils.misc.DebugInfo" href="../utils/misc.html#spsdk.utils.misc.DebugInfo">DebugInfo</a> = &lt;spsdk.utils.misc.DebugInfo object&gt;) ‑> bytes</span>
</code></dt>
<dd>
<div class="desc"><p>Export.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
    &#34;&#34;&#34;Export.&#34;&#34;&#34;
    self._header.length = self.size
    raw_data = self._header.export()
    dbg_info.append_binary_section(&#39;header&#39;, raw_data)
    raw_data += self.data
    dbg_info.append_binary_section(&#39;data&#39;, self.data)
    return raw_data</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.Signature.info"><code class="name flex">
<span>def <span class="ident">info</span></span>(<span>self) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>String representation of the signature.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def info(self) -&gt; str:
    &#34;&#34;&#34;String representation of the signature.&#34;&#34;&#34;
    msg = &#34;-&#34; * 60 + &#34;\n&#34;
    msg += &#34;Signature (Ver: {:X}.{:X}, Size: {})\n&#34;.format(self.version &gt;&gt; 4, self.version &amp; 0xF, len(self._data))
    msg += &#34;-&#34; * 60 + &#34;\n&#34;
    return msg</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="spsdk.image.secret.BaseClass" href="#spsdk.image.secret.BaseClass">BaseClass</a></b></code>:
<ul class="hlist">
<li><code><a title="spsdk.image.secret.BaseClass.version" href="#spsdk.image.secret.BaseClass.version">version</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.version_major" href="#spsdk.image.secret.BaseClass.version_major">version_major</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.version_minor" href="#spsdk.image.secret.BaseClass.version_minor">version_minor</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="spsdk.image.secret.SrkItem"><code class="flex name class">
<span>class <span class="ident">SrkItem</span></span>
<span>(</span><span>modulus: bytes, exponent: bytes, flag: int = 0, algorithm: int = 33)</span>
</code></dt>
<dd>
<div class="desc"><p>Item in SRK Table, see <code><a title="spsdk.image.secret.SrkTable" href="#spsdk.image.secret.SrkTable">SrkTable</a></code> class.</p>
<p>Initialize the srk table item.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SrkItem:
    &#34;&#34;&#34;Item in SRK Table, see `SrkTable` class.&#34;&#34;&#34;

    SRK_TAG = 0xE1

    @property
    def algorithm(self) -&gt; int:
        &#34;&#34;&#34;Algorithm.&#34;&#34;&#34;
        return self._header.param

    @property
    def flag(self) -&gt; int:
        &#34;&#34;&#34;Flag.&#34;&#34;&#34;
        return self._flag

    @flag.setter
    def flag(self, value: int) -&gt; None:
        assert value in (0, 0x80)
        self._flag = value

    @property
    def key_length(self) -&gt; int:
        &#34;&#34;&#34;Key length of Item in SRK Table.&#34;&#34;&#34;
        return len(self.modulus) * 8

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of SrkItem.&#34;&#34;&#34;
        return self._header.length

    def __init__(self, modulus: bytes, exponent: bytes, flag: int = 0,
                 algorithm: int = EnumAlgorithm.PKCS1) -&gt; None:
        &#34;&#34;&#34;Initialize the srk table item.&#34;&#34;&#34;
        assert isinstance(modulus, bytes)
        assert isinstance(exponent, bytes)
        self._header = Header(tag=self.SRK_TAG, param=algorithm)
        self.flag = flag
        self.modulus = modulus
        self.exponent = exponent
        self._header.length += 8 + len(self.modulus) + len(self.exponent)

    def __repr__(self) -&gt; str:
        return &#34;SRK &lt;Algorithm: {}, CA: {}&gt;&#34;.format(EnumAlgorithm[self.algorithm],  # type: ignore
                                                    &#39;YES&#39; if self.flag == 0x80 else &#39;NO&#39;)  # type: ignore

    def __eq__(self, obj: Any) -&gt; bool:
        return isinstance(obj, SrkItem) and vars(obj) == vars(self)

    def __ne__(self, obj: Any) -&gt; bool:
        return not self.__eq__(obj)

    def info(self) -&gt; str:
        &#34;&#34;&#34;String representation of SrkItem.&#34;&#34;&#34;
        msg = str()
        msg += &#34;Algorithm: {}\n&#34;.format(EnumAlgorithm[self.algorithm])  # type: ignore
        msg += &#34;Flag:      0x{:02X} {}\n&#34;.format(self.flag, &#39;(CA)&#39; if self.flag == 0x80 else &#39;&#39;)
        msg += &#34;Length:    {} bit\n&#34;.format(self.key_length)
        msg += &#34;Modulus:\n&#34;
        msg += modulus_fmt(self.modulus)
        msg += &#34;\n&#34;
        msg += &#34;Exponent: {0} (0x{0:X})\n&#34;.format(int.from_bytes(self.exponent, &#39;big&#39;))
        return msg

    def export(self) -&gt; bytes:
        &#34;&#34;&#34;Export.&#34;&#34;&#34;
        data = self._header.export()
        data += pack(&#34;&gt;4B2H&#34;, 0, 0, 0, self.flag, len(self.modulus), len(self.exponent))
        data += bytes(self.modulus)
        data += bytes(self.exponent)
        return data

    @classmethod
    def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;SrkItem&#39;:
        &#34;&#34;&#34;Parse segment from bytes array.

        :param data: The bytes array of SRK segment
        :param offset: The offset of input data
        :return: SrkItem: SrkItem object
        &#34;&#34;&#34;
        header = Header.parse(data, offset, cls.SRK_TAG)
        offset += Header.SIZE + 3
        (flag, modulus_len, exponent_len) = unpack_from(&#34;&gt;B2H&#34;, data, offset)
        offset += 5
        modulus = data[offset: offset + modulus_len]
        offset += modulus_len
        exponent = data[offset: offset + exponent_len]
        return cls(modulus, exponent, flag, header.param)

    @classmethod
    @no_type_check
    def from_certificate(cls, cert: Certificate) -&gt; &#39;SrkItem&#39;:
        &#34;&#34;&#34;Create SRKItem from certificate.&#34;&#34;&#34;
        assert isinstance(cert, Certificate)

        flag = 0

        for extension in cert.extensions:
            if extension.oid._name == &#39;keyUsage&#39;:
                if extension.value.key_cert_sign:
                    flag = 0x80

        # get modulus and exponent of public key
        pub_key_numbers = cert.public_key().public_numbers()
        modulus_len = pub_key_numbers.n.bit_length() // 8
        if pub_key_numbers.n.bit_length() % 8:
            modulus_len += 1
        exponent_len = pub_key_numbers.e.bit_length() // 8
        if pub_key_numbers.e.bit_length() % 8:
            exponent_len += 1
        modulus = pub_key_numbers.n.to_bytes(modulus_len, &#34;big&#34;)
        exponent = pub_key_numbers.e.to_bytes(exponent_len, &#34;big&#34;)

        return cls(modulus, exponent, flag)</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="spsdk.image.secret.SrkItem.SRK_TAG"><code class="name">var <span class="ident">SRK_TAG</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="spsdk.image.secret.SrkItem.from_certificate"><code class="name flex">
<span>def <span class="ident">from_certificate</span></span>(<span>cert: cryptography.x509.base.Certificate) ‑> <a title="spsdk.image.secret.SrkItem" href="#spsdk.image.secret.SrkItem">SrkItem</a></span>
</code></dt>
<dd>
<div class="desc"><p>Create SRKItem from certificate.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
@no_type_check
def from_certificate(cls, cert: Certificate) -&gt; &#39;SrkItem&#39;:
    &#34;&#34;&#34;Create SRKItem from certificate.&#34;&#34;&#34;
    assert isinstance(cert, Certificate)

    flag = 0

    for extension in cert.extensions:
        if extension.oid._name == &#39;keyUsage&#39;:
            if extension.value.key_cert_sign:
                flag = 0x80

    # get modulus and exponent of public key
    pub_key_numbers = cert.public_key().public_numbers()
    modulus_len = pub_key_numbers.n.bit_length() // 8
    if pub_key_numbers.n.bit_length() % 8:
        modulus_len += 1
    exponent_len = pub_key_numbers.e.bit_length() // 8
    if pub_key_numbers.e.bit_length() % 8:
        exponent_len += 1
    modulus = pub_key_numbers.n.to_bytes(modulus_len, &#34;big&#34;)
    exponent = pub_key_numbers.e.to_bytes(exponent_len, &#34;big&#34;)

    return cls(modulus, exponent, flag)</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.SrkItem.parse"><code class="name flex">
<span>def <span class="ident">parse</span></span>(<span>data: bytes, offset: int = 0) ‑> <a title="spsdk.image.secret.SrkItem" href="#spsdk.image.secret.SrkItem">SrkItem</a></span>
</code></dt>
<dd>
<div class="desc"><p>Parse segment from bytes array.</p>
<p>:param data: The bytes array of SRK segment
:param offset: The offset of input data
:return: SrkItem: SrkItem object</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;SrkItem&#39;:
    &#34;&#34;&#34;Parse segment from bytes array.

    :param data: The bytes array of SRK segment
    :param offset: The offset of input data
    :return: SrkItem: SrkItem object
    &#34;&#34;&#34;
    header = Header.parse(data, offset, cls.SRK_TAG)
    offset += Header.SIZE + 3
    (flag, modulus_len, exponent_len) = unpack_from(&#34;&gt;B2H&#34;, data, offset)
    offset += 5
    modulus = data[offset: offset + modulus_len]
    offset += modulus_len
    exponent = data[offset: offset + exponent_len]
    return cls(modulus, exponent, flag, header.param)</code></pre>
</details>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="spsdk.image.secret.SrkItem.algorithm"><code class="name">var <span class="ident">algorithm</span> : int</code></dt>
<dd>
<div class="desc"><p>Algorithm.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def algorithm(self) -&gt; int:
    &#34;&#34;&#34;Algorithm.&#34;&#34;&#34;
    return self._header.param</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.SrkItem.flag"><code class="name">var <span class="ident">flag</span> : int</code></dt>
<dd>
<div class="desc"><p>Flag.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def flag(self) -&gt; int:
    &#34;&#34;&#34;Flag.&#34;&#34;&#34;
    return self._flag</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.SrkItem.key_length"><code class="name">var <span class="ident">key_length</span> : int</code></dt>
<dd>
<div class="desc"><p>Key length of Item in SRK Table.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def key_length(self) -&gt; int:
    &#34;&#34;&#34;Key length of Item in SRK Table.&#34;&#34;&#34;
    return len(self.modulus) * 8</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.SrkItem.size"><code class="name">var <span class="ident">size</span> : int</code></dt>
<dd>
<div class="desc"><p>Size of SrkItem.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def size(self) -&gt; int:
    &#34;&#34;&#34;Size of SrkItem.&#34;&#34;&#34;
    return self._header.length</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="spsdk.image.secret.SrkItem.export"><code class="name flex">
<span>def <span class="ident">export</span></span>(<span>self) ‑> bytes</span>
</code></dt>
<dd>
<div class="desc"><p>Export.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def export(self) -&gt; bytes:
    &#34;&#34;&#34;Export.&#34;&#34;&#34;
    data = self._header.export()
    data += pack(&#34;&gt;4B2H&#34;, 0, 0, 0, self.flag, len(self.modulus), len(self.exponent))
    data += bytes(self.modulus)
    data += bytes(self.exponent)
    return data</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.SrkItem.info"><code class="name flex">
<span>def <span class="ident">info</span></span>(<span>self) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>String representation of SrkItem.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def info(self) -&gt; str:
    &#34;&#34;&#34;String representation of SrkItem.&#34;&#34;&#34;
    msg = str()
    msg += &#34;Algorithm: {}\n&#34;.format(EnumAlgorithm[self.algorithm])  # type: ignore
    msg += &#34;Flag:      0x{:02X} {}\n&#34;.format(self.flag, &#39;(CA)&#39; if self.flag == 0x80 else &#39;&#39;)
    msg += &#34;Length:    {} bit\n&#34;.format(self.key_length)
    msg += &#34;Modulus:\n&#34;
    msg += modulus_fmt(self.modulus)
    msg += &#34;\n&#34;
    msg += &#34;Exponent: {0} (0x{0:X})\n&#34;.format(int.from_bytes(self.exponent, &#39;big&#39;))
    return msg</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="spsdk.image.secret.SrkTable"><code class="flex name class">
<span>class <span class="ident">SrkTable</span></span>
<span>(</span><span>version: int = 64)</span>
</code></dt>
<dd>
<div class="desc"><p>SRK table.</p>
<p>Initialize SRT Table.</p>
<p>:param version: format version</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SrkTable(BaseClass):
    &#34;&#34;&#34;SRK table.&#34;&#34;&#34;

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Size of SRK table.&#34;&#34;&#34;
        size = Header.SIZE
        for key in self._keys:
            size += key.size
        return size

    def __init__(self, version: int = 0x40) -&gt; None:
        &#34;&#34;&#34;Initialize SRT Table.

        :param version: format version
        &#34;&#34;&#34;
        super().__init__(tag=SegTag.CRT, version=version)
        self._keys: List[SrkItem] = []

    def __repr__(self) -&gt; str:
        return &#34;SRK_Table &lt;Version: {:X}.{:X}, Keys: {}&gt;&#34;.format(self.version_major,
                                                                 self.version_minor, len(self._keys))

    def __eq__(self, obj: Any) -&gt; bool:
        return isinstance(obj, SrkTable) and vars(obj) == vars(self)

    def __ne__(self, obj: Any) -&gt; bool:
        return not self.__eq__(obj)

    def __len__(self) -&gt; int:
        return len(self._keys)

    def __getitem__(self, key: int) -&gt; SrkItem:
        return self._keys[key]

    def __setitem__(self, key: int, value: SrkItem) -&gt; None:
        assert isinstance(value, SrkItem)
        self._keys[key] = value

    def __iter__(self) -&gt; Iterator[SrkItem]:
        return self._keys.__iter__()

    def info(self) -&gt; str:
        &#34;&#34;&#34;Text info about the instance.&#34;&#34;&#34;
        msg = &#34;-&#34; * 60 + &#34;\n&#34;
        msg += &#34;SRK Table (Version: {:X}.{:X}, #Keys: {})\n&#34;.format(self.version_major,
                                                                    self.version_minor,
                                                                    len(self._keys))
        msg += &#34;-&#34; * 60 + &#34;\n&#34;
        for i, srk in enumerate(self._keys):
            msg += f&#34;SRK Key Index: {i} \n&#34;
            msg += srk.info()
            msg += &#34;\n&#34;
        return msg

    def append(self, srk: SrkItem) -&gt; None:
        &#34;&#34;&#34;Add SRK item.

        :param srk: item to be added
        &#34;&#34;&#34;
        self._keys.append(srk)

    def get_fuse(self, index: int) -&gt; int:
        &#34;&#34;&#34;Retrieve fuse value for the given index.

        :param index: of the fuse, 0-7
        :return: value of the specified fuse; the value is in format, that cane be used as parameter for SDP
                `efuse_read_once` or `efuse_write_once`
        &#34;&#34;&#34;
        assert 0 &lt;= index &lt; 8
        int_data = self.export_fuses()[index * 4: (1 + index) * 4]
        assert len(int_data) == 4
        return unpack(&#34;&lt;I&#34;, int_data)[0]

    def export_fuses(self) -&gt; bytes:
        &#34;&#34;&#34;SRK items in binary form, see `SRK_fuses.bin` file.&#34;&#34;&#34;
        data = b&#39;&#39;
        for srk in self._keys:
            srk_data = srk.export()
            data += sha256(srk_data).digest()
        return sha256(data).digest()

    def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
        &#34;&#34;&#34;Export into binary form (serialization).

        :param dbg_info: optional instance allowing to debug exported content
        :return: binary representation of the instance
        &#34;&#34;&#34;
        self._header.length = self.size
        raw_data = self._header.export()
        dbg_info.append_binary_section(&#39;header&#39;, raw_data)
        for srk in self._keys:
            item_data = srk.export()
            raw_data += item_data
            dbg_info.append_binary_section(&#39;srk_item&#39;, item_data)
        return raw_data

    @classmethod
    def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;SrkTable&#39;:
        &#34;&#34;&#34;Parse of SRK table.&#34;&#34;&#34;
        header = Header.parse(data, offset, SegTag.CRT)
        offset += Header.SIZE
        obj = cls(header.param)
        obj._header.length = header.length
        length = header.length - Header.SIZE
        while length &gt; 0:
            srk = SrkItem.parse(data, offset)
            offset += srk.size
            length -= srk.size
            obj.append(srk)
        return obj</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="spsdk.image.secret.BaseClass" href="#spsdk.image.secret.BaseClass">BaseClass</a></li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="spsdk.image.secret.SrkTable.parse"><code class="name flex">
<span>def <span class="ident">parse</span></span>(<span>data: bytes, offset: int = 0) ‑> <a title="spsdk.image.secret.SrkTable" href="#spsdk.image.secret.SrkTable">SrkTable</a></span>
</code></dt>
<dd>
<div class="desc"><p>Parse of SRK table.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def parse(cls, data: bytes, offset: int = 0) -&gt; &#39;SrkTable&#39;:
    &#34;&#34;&#34;Parse of SRK table.&#34;&#34;&#34;
    header = Header.parse(data, offset, SegTag.CRT)
    offset += Header.SIZE
    obj = cls(header.param)
    obj._header.length = header.length
    length = header.length - Header.SIZE
    while length &gt; 0:
        srk = SrkItem.parse(data, offset)
        offset += srk.size
        length -= srk.size
        obj.append(srk)
    return obj</code></pre>
</details>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="spsdk.image.secret.SrkTable.size"><code class="name">var <span class="ident">size</span> : int</code></dt>
<dd>
<div class="desc"><p>Size of SRK table.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def size(self) -&gt; int:
    &#34;&#34;&#34;Size of SRK table.&#34;&#34;&#34;
    size = Header.SIZE
    for key in self._keys:
        size += key.size
    return size</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="spsdk.image.secret.SrkTable.append"><code class="name flex">
<span>def <span class="ident">append</span></span>(<span>self, srk: <a title="spsdk.image.secret.SrkItem" href="#spsdk.image.secret.SrkItem">SrkItem</a>) ‑> NoneType</span>
</code></dt>
<dd>
<div class="desc"><p>Add SRK item.</p>
<p>:param srk: item to be added</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def append(self, srk: SrkItem) -&gt; None:
    &#34;&#34;&#34;Add SRK item.

    :param srk: item to be added
    &#34;&#34;&#34;
    self._keys.append(srk)</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.SrkTable.export"><code class="name flex">
<span>def <span class="ident">export</span></span>(<span>self, dbg_info: <a title="spsdk.utils.misc.DebugInfo" href="../utils/misc.html#spsdk.utils.misc.DebugInfo">DebugInfo</a> = &lt;spsdk.utils.misc.DebugInfo object&gt;) ‑> bytes</span>
</code></dt>
<dd>
<div class="desc"><p>Export into binary form (serialization).</p>
<p>:param dbg_info: optional instance allowing to debug exported content
:return: binary representation of the instance</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def export(self, dbg_info: DebugInfo = DebugInfo.disabled()) -&gt; bytes:
    &#34;&#34;&#34;Export into binary form (serialization).

    :param dbg_info: optional instance allowing to debug exported content
    :return: binary representation of the instance
    &#34;&#34;&#34;
    self._header.length = self.size
    raw_data = self._header.export()
    dbg_info.append_binary_section(&#39;header&#39;, raw_data)
    for srk in self._keys:
        item_data = srk.export()
        raw_data += item_data
        dbg_info.append_binary_section(&#39;srk_item&#39;, item_data)
    return raw_data</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.SrkTable.export_fuses"><code class="name flex">
<span>def <span class="ident">export_fuses</span></span>(<span>self) ‑> bytes</span>
</code></dt>
<dd>
<div class="desc"><p>SRK items in binary form, see <code>SRK_fuses.bin</code> file.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def export_fuses(self) -&gt; bytes:
    &#34;&#34;&#34;SRK items in binary form, see `SRK_fuses.bin` file.&#34;&#34;&#34;
    data = b&#39;&#39;
    for srk in self._keys:
        srk_data = srk.export()
        data += sha256(srk_data).digest()
    return sha256(data).digest()</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.SrkTable.get_fuse"><code class="name flex">
<span>def <span class="ident">get_fuse</span></span>(<span>self, index: int) ‑> int</span>
</code></dt>
<dd>
<div class="desc"><p>Retrieve fuse value for the given index.</p>
<p>:param index: of the fuse, 0-7
:return: value of the specified fuse; the value is in format, that cane be used as parameter for SDP
<code>efuse_read_once</code> or <code>efuse_write_once</code></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_fuse(self, index: int) -&gt; int:
    &#34;&#34;&#34;Retrieve fuse value for the given index.

    :param index: of the fuse, 0-7
    :return: value of the specified fuse; the value is in format, that cane be used as parameter for SDP
            `efuse_read_once` or `efuse_write_once`
    &#34;&#34;&#34;
    assert 0 &lt;= index &lt; 8
    int_data = self.export_fuses()[index * 4: (1 + index) * 4]
    assert len(int_data) == 4
    return unpack(&#34;&lt;I&#34;, int_data)[0]</code></pre>
</details>
</dd>
<dt id="spsdk.image.secret.SrkTable.info"><code class="name flex">
<span>def <span class="ident">info</span></span>(<span>self) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>Text info about the instance.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def info(self) -&gt; str:
    &#34;&#34;&#34;Text info about the instance.&#34;&#34;&#34;
    msg = &#34;-&#34; * 60 + &#34;\n&#34;
    msg += &#34;SRK Table (Version: {:X}.{:X}, #Keys: {})\n&#34;.format(self.version_major,
                                                                self.version_minor,
                                                                len(self._keys))
    msg += &#34;-&#34; * 60 + &#34;\n&#34;
    for i, srk in enumerate(self._keys):
        msg += f&#34;SRK Key Index: {i} \n&#34;
        msg += srk.info()
        msg += &#34;\n&#34;
    return msg</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="spsdk.image.secret.BaseClass" href="#spsdk.image.secret.BaseClass">BaseClass</a></b></code>:
<ul class="hlist">
<li><code><a title="spsdk.image.secret.BaseClass.version" href="#spsdk.image.secret.BaseClass.version">version</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.version_major" href="#spsdk.image.secret.BaseClass.version_major">version_major</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.version_minor" href="#spsdk.image.secret.BaseClass.version_minor">version_minor</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="spsdk.image" href="index.html">spsdk.image</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="spsdk.image.secret.BaseClass" href="#spsdk.image.secret.BaseClass">BaseClass</a></code></h4>
<ul class="two-column">
<li><code><a title="spsdk.image.secret.BaseClass.export" href="#spsdk.image.secret.BaseClass.export">export</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.info" href="#spsdk.image.secret.BaseClass.info">info</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.size" href="#spsdk.image.secret.BaseClass.size">size</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.version" href="#spsdk.image.secret.BaseClass.version">version</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.version_major" href="#spsdk.image.secret.BaseClass.version_major">version_major</a></code></li>
<li><code><a title="spsdk.image.secret.BaseClass.version_minor" href="#spsdk.image.secret.BaseClass.version_minor">version_minor</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="spsdk.image.secret.CertificateImg" href="#spsdk.image.secret.CertificateImg">CertificateImg</a></code></h4>
<ul class="">
<li><code><a title="spsdk.image.secret.CertificateImg.export" href="#spsdk.image.secret.CertificateImg.export">export</a></code></li>
<li><code><a title="spsdk.image.secret.CertificateImg.info" href="#spsdk.image.secret.CertificateImg.info">info</a></code></li>
<li><code><a title="spsdk.image.secret.CertificateImg.parse" href="#spsdk.image.secret.CertificateImg.parse">parse</a></code></li>
<li><code><a title="spsdk.image.secret.CertificateImg.size" href="#spsdk.image.secret.CertificateImg.size">size</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="spsdk.image.secret.EnumAlgorithm" href="#spsdk.image.secret.EnumAlgorithm">EnumAlgorithm</a></code></h4>
<ul class="two-column">
<li><code><a title="spsdk.image.secret.EnumAlgorithm.AES" href="#spsdk.image.secret.EnumAlgorithm.AES">AES</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.ANY" href="#spsdk.image.secret.EnumAlgorithm.ANY">ANY</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.BLOB" href="#spsdk.image.secret.EnumAlgorithm.BLOB">BLOB</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.CCM" href="#spsdk.image.secret.EnumAlgorithm.CCM">CCM</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.CIPHER" href="#spsdk.image.secret.EnumAlgorithm.CIPHER">CIPHER</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.EC" href="#spsdk.image.secret.EnumAlgorithm.EC">EC</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.F" href="#spsdk.image.secret.EnumAlgorithm.F">F</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.HASH" href="#spsdk.image.secret.EnumAlgorithm.HASH">HASH</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.MODE" href="#spsdk.image.secret.EnumAlgorithm.MODE">MODE</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.PKCS1" href="#spsdk.image.secret.EnumAlgorithm.PKCS1">PKCS1</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.SHA1" href="#spsdk.image.secret.EnumAlgorithm.SHA1">SHA1</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.SHA256" href="#spsdk.image.secret.EnumAlgorithm.SHA256">SHA256</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.SHA512" href="#spsdk.image.secret.EnumAlgorithm.SHA512">SHA512</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.SIG" href="#spsdk.image.secret.EnumAlgorithm.SIG">SIG</a></code></li>
<li><code><a title="spsdk.image.secret.EnumAlgorithm.WRAP" href="#spsdk.image.secret.EnumAlgorithm.WRAP">WRAP</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="spsdk.image.secret.MAC" href="#spsdk.image.secret.MAC">MAC</a></code></h4>
<ul class="">
<li><code><a title="spsdk.image.secret.MAC.AES128_BLK_LEN" href="#spsdk.image.secret.MAC.AES128_BLK_LEN">AES128_BLK_LEN</a></code></li>
<li><code><a title="spsdk.image.secret.MAC.data" href="#spsdk.image.secret.MAC.data">data</a></code></li>
<li><code><a title="spsdk.image.secret.MAC.export" href="#spsdk.image.secret.MAC.export">export</a></code></li>
<li><code><a title="spsdk.image.secret.MAC.info" href="#spsdk.image.secret.MAC.info">info</a></code></li>
<li><code><a title="spsdk.image.secret.MAC.mac" href="#spsdk.image.secret.MAC.mac">mac</a></code></li>
<li><code><a title="spsdk.image.secret.MAC.nonce" href="#spsdk.image.secret.MAC.nonce">nonce</a></code></li>
<li><code><a title="spsdk.image.secret.MAC.parse" href="#spsdk.image.secret.MAC.parse">parse</a></code></li>
<li><code><a title="spsdk.image.secret.MAC.size" href="#spsdk.image.secret.MAC.size">size</a></code></li>
<li><code><a title="spsdk.image.secret.MAC.update_aead_encryption_params" href="#spsdk.image.secret.MAC.update_aead_encryption_params">update_aead_encryption_params</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="spsdk.image.secret.SecretKeyBlob" href="#spsdk.image.secret.SecretKeyBlob">SecretKeyBlob</a></code></h4>
<ul class="">
<li><code><a title="spsdk.image.secret.SecretKeyBlob.blob" href="#spsdk.image.secret.SecretKeyBlob.blob">blob</a></code></li>
<li><code><a title="spsdk.image.secret.SecretKeyBlob.export" href="#spsdk.image.secret.SecretKeyBlob.export">export</a></code></li>
<li><code><a title="spsdk.image.secret.SecretKeyBlob.info" href="#spsdk.image.secret.SecretKeyBlob.info">info</a></code></li>
<li><code><a title="spsdk.image.secret.SecretKeyBlob.parse" href="#spsdk.image.secret.SecretKeyBlob.parse">parse</a></code></li>
<li><code><a title="spsdk.image.secret.SecretKeyBlob.size" href="#spsdk.image.secret.SecretKeyBlob.size">size</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="spsdk.image.secret.Signature" href="#spsdk.image.secret.Signature">Signature</a></code></h4>
<ul class="">
<li><code><a title="spsdk.image.secret.Signature.data" href="#spsdk.image.secret.Signature.data">data</a></code></li>
<li><code><a title="spsdk.image.secret.Signature.export" href="#spsdk.image.secret.Signature.export">export</a></code></li>
<li><code><a title="spsdk.image.secret.Signature.info" href="#spsdk.image.secret.Signature.info">info</a></code></li>
<li><code><a title="spsdk.image.secret.Signature.parse" href="#spsdk.image.secret.Signature.parse">parse</a></code></li>
<li><code><a title="spsdk.image.secret.Signature.size" href="#spsdk.image.secret.Signature.size">size</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="spsdk.image.secret.SrkItem" href="#spsdk.image.secret.SrkItem">SrkItem</a></code></h4>
<ul class="two-column">
<li><code><a title="spsdk.image.secret.SrkItem.SRK_TAG" href="#spsdk.image.secret.SrkItem.SRK_TAG">SRK_TAG</a></code></li>
<li><code><a title="spsdk.image.secret.SrkItem.algorithm" href="#spsdk.image.secret.SrkItem.algorithm">algorithm</a></code></li>
<li><code><a title="spsdk.image.secret.SrkItem.export" href="#spsdk.image.secret.SrkItem.export">export</a></code></li>
<li><code><a title="spsdk.image.secret.SrkItem.flag" href="#spsdk.image.secret.SrkItem.flag">flag</a></code></li>
<li><code><a title="spsdk.image.secret.SrkItem.from_certificate" href="#spsdk.image.secret.SrkItem.from_certificate">from_certificate</a></code></li>
<li><code><a title="spsdk.image.secret.SrkItem.info" href="#spsdk.image.secret.SrkItem.info">info</a></code></li>
<li><code><a title="spsdk.image.secret.SrkItem.key_length" href="#spsdk.image.secret.SrkItem.key_length">key_length</a></code></li>
<li><code><a title="spsdk.image.secret.SrkItem.parse" href="#spsdk.image.secret.SrkItem.parse">parse</a></code></li>
<li><code><a title="spsdk.image.secret.SrkItem.size" href="#spsdk.image.secret.SrkItem.size">size</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="spsdk.image.secret.SrkTable" href="#spsdk.image.secret.SrkTable">SrkTable</a></code></h4>
<ul class="two-column">
<li><code><a title="spsdk.image.secret.SrkTable.append" href="#spsdk.image.secret.SrkTable.append">append</a></code></li>
<li><code><a title="spsdk.image.secret.SrkTable.export" href="#spsdk.image.secret.SrkTable.export">export</a></code></li>
<li><code><a title="spsdk.image.secret.SrkTable.export_fuses" href="#spsdk.image.secret.SrkTable.export_fuses">export_fuses</a></code></li>
<li><code><a title="spsdk.image.secret.SrkTable.get_fuse" href="#spsdk.image.secret.SrkTable.get_fuse">get_fuse</a></code></li>
<li><code><a title="spsdk.image.secret.SrkTable.info" href="#spsdk.image.secret.SrkTable.info">info</a></code></li>
<li><code><a title="spsdk.image.secret.SrkTable.parse" href="#spsdk.image.secret.SrkTable.parse">parse</a></code></li>
<li><code><a title="spsdk.image.secret.SrkTable.size" href="#spsdk.image.secret.SrkTable.size">size</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>